import numpy as np
from numpy.random import beta as betarnd
from numpy.random import gamma as gammarnd
from numpy.random import normal as normalrnd
from random import sample
from random import shuffle
import pandas as pd
import seaborn as sns
import random
import matplotlib.pyplot as plt
from scipy.stats import gamma

sns.set(context='notebook', style='white', palette='deep', font='arial', font_scale=1.3, color_codes=True, rc=None)
# num_subjects=192
# mean_diffs=[]
# for i in range(10000):
# 	rfi_rews2=list(gammarnd(0.4275512172820504, 1.6876320240266436,num_subjects))
# 	rfi_preds2=list(gammarnd(0.6019802760339684, 1.4308407307549147,num_subjects))
# 	rfi_rews=[]
# 	rfi_preds=[]
# 	for i in range(192):
# 		if random.uniform(0,1)>0.5:
# 			rfi_rews.append(rfi_rews2[i])
# 			rfi_preds.append(rfi_preds2[i])
# 		else:
# 			rfi_rews.append(rfi_preds2[i])
# 			rfi_preds.append(rfi_rews2[i])
# 	mean_diffs.append(np.mean(rfi_rews)-np.mean(rfi_preds))

# print('mean of mean diffs {}'.format(np.mean(mean_diffs)))
# print('SD of mean diffs null {}'.format(np.std(mean_diffs)))
# temp_f=pd.Series(mean_diffs,name='mean differences of null')
# sns.distplot(temp_f)
# plt.savefig("mean_diffs.png",bbox_inches='tight', dpi=300)
# plt.ylabel('density')
# plt.show()
betas_rfi_reward=[0.19235187068961024, 0.6077259308084503, 0.4316290930277108, 0.37280538740619806, 0.3842427490648481, 0.638724294605487, 0.32165060718515803, 1.147764750904775, 1.480617749101014, 0.329640831464303, 0.3988750711519108, 0.7644095940016682, 0.6233900866062626, 0.29324879755878586, 0.4914962745885104, 1.5814903330649857, 0.5969092459833897, 0.12793299074353467, 0.21455480583916897, 0.8756189216039829, 0.9862147373509887, 0.19570325709005415, 0.40070176755276404, 1.3435243851875087, 0.2475994776402745, 0.6566661179538917, 0.17610595482729746, 0.8922692822478224, 0.22122704830734255, 2.2710661698831123, 0.38818104985271806, 0.9658868171811751, 0.5500045509190044, 2.8155616022080583, 1.4041788364753707, 0.4790206486117646, 2.2276480701014694, 0.751422440217316, 0.6627992297662487, 4.827750889665758, 0.15639096125216304, 1.4083810770748004, 2.1194472001283584, 0.21097727764834523, 0.295627881655672, 0.5337514394050886, 0.5835815019715404, 0.4954192411822244, 1.3695075845484361, 0.20385301654784202, 0.5732220377705965, 1.7370233294765656, 0.9818793266878698, 0.08487037225611585, 1.289082436695063, 0.47461403781919764, 0.16118930831818698, 0.8177526047419068, 0.523766188688736, 0.4932885489050485, 0.5584784962323759, 0.5145219331370661, 0.17678113355988292, 0.1194168269082535, 0.36427744103112114, 0.5083890652810892, 0.17892155571420038, 0.8437478068354695, 0.42640657243473146, 0.9158287420024933, 0.3553181125748022, 3.1840690127338482, 0.38445834408568275, 0.47154127232893517, 0.18561005957195062, 0.14495633601500754, 0.764597227477761, 1.3187082133765906, 0.13695627979984665, 0.18411002867707565, 0.3351187323838063, 0.9665357018264742, 0.2315179727970711, 0.526060941841667, 1.8041479253840238, 0.271464343090779, 0.5298678541985878, 0.2593997660059637, 0.08351465806726399, 0.14104252488403632, 0.36336085205402663, 0.14464017755780217, 0.21687153051192679, 0.5207263484737815, 0.09892204270235522, 1.255847346333231, 0.9512869105897688, 0.3111661176693852, 0.4523773651051018, 0.7367436622260206, 1.2716864320681085, 0.05329801095954473, 0.21122329902641582, 1.5127800298766545, 1.482877486069001, 0.1861582090109545, 0.7844005112983942, 2.153518856287157, 0.7275081678849366, 0.22170632111516567, 0.5996096971172464, 0.9199514737384364, 0.661064975709092, 1.1342999807848007, 0.3456625863696403, 0.6734564138170364, 0.7491647848099499, 2.960113423456845, 1.1341582796813872, 1.093771393980663, 0.41210277676286683, 0.19918219690990432, 0.468669232676564, 0.6978640761698266, 0.3356377234621715, 0.23222052863991263, 0.2892964262372132, 0.21150079807068561, 0.4594230340460251, 0.9094412142507351, 0.3547870460813049, 0.28082333515387287, 1.9746962620487474, 0.31592632306617413, 0.75103111481448, 0.5170773886621892, 0.4107303481897596, 0.7769342459113561, 0.5532763561409736, 2.5046091658148693, 0.3584451957663368, 0.6553665960204157, 0.7707609034359856, 0.2274959433221783, 0.27577134941562104, 0.1859307510942477, 1.3428807013555124, 3.321475771866423, 2.5944096242731134, 0.26801233259394386, 1.4993338950337942, 0.15301843355142217, 1.2525369616426305, 2.187508581456703, 0.6344495129187682, 0.5641759637623258, 0.5006045109931482, 0.4632885345251246, 0.37879240581938006, 0.19118048645882907, 0.45501530426439707, 0.17989428939269092, 1.463497064074139, 0.7665662441578112, 0.5559212987089153, 0.8243837870430174, 0.31822775068942233, 0.5491672906716699, 0.3163272069818333, 0.22478647989240305, 0.12208138081490617, 0.32406972515353144, 0.250796539861831, 0.44574203207194013, 0.34485222315782127, 0.6812552662181826, 0.1995403194313377, 0.6722587258083988, 0.25680032549889625, 1.1776895931222529, 0.20619443498087697, 0.44244219215907843, 0.5773021883876015, 0.23703835935252648, 0.6023249577262025, 0.773750806112092, 1.2208674317753203, 1.199667941286403, 0.6310024371045868, 0.4388065086962609, 0.5478878777038035, 0.6247817223259977]
betas_rfi_predator=[0.5813607480634874, 0.46500139515236366, 0.022037823768344143, 0.4210891530308329, 0.13629339612127309, 0.21123053914777248, 0.8153866193147118, 0.173034882865118, 1.2013890206152986, 0.8337937305809614, 1.7454396901026794, 1.3038966291234695, 0.3977484609912338, 0.4417885124254332, 0.3506774404508218, 0.594444359778576, 1.2672890430258617, 0.2498904182573718, 1.304227373220293, 0.24879778917853987, 0.7238826940291087, 0.14917206291145454, 0.40970440626443216, 0.7739384349231968, 0.2894776914222145, 0.1539148531797498, 0.20388301818473492, 0.9403608407524155, 0.5472282208633708, 0.3452607544060491, 2.4462244334891663, 0.27288337753171305, 1.123141844425255, 0.5736156511131265, 1.440372592782029, 0.23844600611558803, 1.7677375892755878, 0.7002695721286292, 0.7550044487104126, 0.1858162765165882, 0.15650217150714524, 0.5528427929112373, 0.48452632726844397, 0.6041644173094095, 0.3296861506950335, 2.1175421590273293, 1.5857464093134817, 1.3385728879696275, 1.6151657551343435, 1.6509465770110063, 1.7954900853986233, 1.2998506517473412, 1.6665563086617816, 0.8147137296643906, 1.3117634348081206, 0.2575065704197746, 0.22782257964126051, 0.2666183950937404, 0.9560755571477461, 0.3622808602542228, 0.15475438274659875, 0.3801620721045771, 0.6617563917907218, 0.5568675564312904, 1.210370113183292, 0.6968765000151409, 0.6614114171813925, 0.46635454801903004, 0.6612540640823149, 1.650604913449891, 0.3525236460732731, 0.4474550642637168, 0.5477143469088364, 0.4510639156989574, 0.0427191410432032, 0.7029363784073258, 0.2536421898958513, 0.6185421380277689, 0.30606654157982743, 1.1393893066996725, 0.20881672268110665, 0.13636894896533566, 1.6256422311635068, 1.154356475728921, 1.2345682519109054, 0.06847218889733361, 0.9755956503564591, 0.47518176697233316, 0.6229888645544398, 0.45280788835574237, 0.35808485460078543, 0.30921212117720986, 0.24462225366170864, 2.6643607542674603, 0.08776591833312931, 0.6431511032830839, 0.32103768482399, 0.5478947417715673, 0.4450283293511528, 0.8866743885242757, 2.433350083259334, 0.2474660173003349, 0.2602769311070811, 1.0286652924950075, 1.8135916951788744, 0.32222582318952403, 0.42452502488323207, 1.8965449782176882, 2.243078027449153, 0.22952174103227357, 0.3161811408271306, 0.7177958880569163, 0.5097896834371897, 0.3649884854988208, 0.4527696601728975, 1.6292295266117782, 0.9618425185561703, 1.534401751595094, 0.7924368143819853, 0.3346494832429789, 0.3840384722354999, 0.4420818547728413, 0.2307622435788997, 0.24236238411113703, 0.7261816079958722, 0.19643063491494409, 0.19237045488199622, 0.3434242503026401, 0.4833325743687742, 0.33752691973716054, 0.6673197675378232, 0.1725027907667647, 1.8700656948736198, 0.661857133212305, 0.11021091252115008, 0.6231186018610759, 0.6445161440684875, 1.7113866541877052, 0.9937207197738676, 2.4323016073620867, 0.5538391552004449, 1.0528403262697563, 0.7782662662059137, 0.2787103369442513, 0.23108314875420788, 1.4786432674926266, 0.7314043631946712, 1.1436203119536688, 1.8500755573420808, 0.20710128458690752, 1.472457425209345, 0.8526311623243544, 0.9688767107755216, 0.566393724989701, 0.3746118935023774, 0.46984591903220185, 0.5234681651709919, 0.22178386796450436, 0.3840869303674608, 0.2984492752336955, 0.89814283928682, 0.8713963926495465, 1.1097570531832615, 2.2819203520167215, 0.7619248410211255, 0.5440086268410668, 0.33537710361043765, 0.8490598321506136, 0.3982305456693872, 0.34421040709373085, 0.14075787006040746, 0.16626012480849223, 0.23436988696862987, 0.5655378342532504, 0.2025518151909286, 0.5559522289022872, 0.34314826834987766, 1.2491903465493035, 0.6518938395988793, 0.5886509507040979, 0.5867568434030319, 0.5436104547785391, 1.8625657126380506, 0.14309680423016044, 0.31071472725139515, 0.3504535524632973, 0.30961707131729027, 0.3025099641199006, 1.5039354159586646, 1.0108989466448435, 0.23975490460891613, 1.972460309083591]



print(np.mean(betas_rfi_reward))
print(np.std(betas_rfi_reward))
print(np.mean(betas_rfi_predator))
print(np.std(betas_rfi_predator))


sns.set(context='notebook', style='white', palette='deep', font='arial', font_scale=1.3, color_codes=True, rc=None)
num_subjects=192
mean_diffs=[]
median_diffs=[]
SDs = []
simulations=10000
for i in range(simulations):
	betas_rfi_reward=[0.19235187068961024, 0.6077259308084503, 0.4316290930277108, 0.37280538740619806, 0.3842427490648481, 0.638724294605487, 0.32165060718515803, 1.147764750904775, 1.480617749101014, 0.329640831464303, 0.3988750711519108, 0.7644095940016682, 0.6233900866062626, 0.29324879755878586, 0.4914962745885104, 1.5814903330649857, 0.5969092459833897, 0.12793299074353467, 0.21455480583916897, 0.8756189216039829, 0.9862147373509887, 0.19570325709005415, 0.40070176755276404, 1.3435243851875087, 0.2475994776402745, 0.6566661179538917, 0.17610595482729746, 0.8922692822478224, 0.22122704830734255, 2.2710661698831123, 0.38818104985271806, 0.9658868171811751, 0.5500045509190044, 2.8155616022080583, 1.4041788364753707, 0.4790206486117646, 2.2276480701014694, 0.751422440217316, 0.6627992297662487, 4.827750889665758, 0.15639096125216304, 1.4083810770748004, 2.1194472001283584, 0.21097727764834523, 0.295627881655672, 0.5337514394050886, 0.5835815019715404, 0.4954192411822244, 1.3695075845484361, 0.20385301654784202, 0.5732220377705965, 1.7370233294765656, 0.9818793266878698, 0.08487037225611585, 1.289082436695063, 0.47461403781919764, 0.16118930831818698, 0.8177526047419068, 0.523766188688736, 0.4932885489050485, 0.5584784962323759, 0.5145219331370661, 0.17678113355988292, 0.1194168269082535, 0.36427744103112114, 0.5083890652810892, 0.17892155571420038, 0.8437478068354695, 0.42640657243473146, 0.9158287420024933, 0.3553181125748022, 3.1840690127338482, 0.38445834408568275, 0.47154127232893517, 0.18561005957195062, 0.14495633601500754, 0.764597227477761, 1.3187082133765906, 0.13695627979984665, 0.18411002867707565, 0.3351187323838063, 0.9665357018264742, 0.2315179727970711, 0.526060941841667, 1.8041479253840238, 0.271464343090779, 0.5298678541985878, 0.2593997660059637, 0.08351465806726399, 0.14104252488403632, 0.36336085205402663, 0.14464017755780217, 0.21687153051192679, 0.5207263484737815, 0.09892204270235522, 1.255847346333231, 0.9512869105897688, 0.3111661176693852, 0.4523773651051018, 0.7367436622260206, 1.2716864320681085, 0.05329801095954473, 0.21122329902641582, 1.5127800298766545, 1.482877486069001, 0.1861582090109545, 0.7844005112983942, 2.153518856287157, 0.7275081678849366, 0.22170632111516567, 0.5996096971172464, 0.9199514737384364, 0.661064975709092, 1.1342999807848007, 0.3456625863696403, 0.6734564138170364, 0.7491647848099499, 2.960113423456845, 1.1341582796813872, 1.093771393980663, 0.41210277676286683, 0.19918219690990432, 0.468669232676564, 0.6978640761698266, 0.3356377234621715, 0.23222052863991263, 0.2892964262372132, 0.21150079807068561, 0.4594230340460251, 0.9094412142507351, 0.3547870460813049, 0.28082333515387287, 1.9746962620487474, 0.31592632306617413, 0.75103111481448, 0.5170773886621892, 0.4107303481897596, 0.7769342459113561, 0.5532763561409736, 2.5046091658148693, 0.3584451957663368, 0.6553665960204157, 0.7707609034359856, 0.2274959433221783, 0.27577134941562104, 0.1859307510942477, 1.3428807013555124, 3.321475771866423, 2.5944096242731134, 0.26801233259394386, 1.4993338950337942, 0.15301843355142217, 1.2525369616426305, 2.187508581456703, 0.6344495129187682, 0.5641759637623258, 0.5006045109931482, 0.4632885345251246, 0.37879240581938006, 0.19118048645882907, 0.45501530426439707, 0.17989428939269092, 1.463497064074139, 0.7665662441578112, 0.5559212987089153, 0.8243837870430174, 0.31822775068942233, 0.5491672906716699, 0.3163272069818333, 0.22478647989240305, 0.12208138081490617, 0.32406972515353144, 0.250796539861831, 0.44574203207194013, 0.34485222315782127, 0.6812552662181826, 0.1995403194313377, 0.6722587258083988, 0.25680032549889625, 1.1776895931222529, 0.20619443498087697, 0.44244219215907843, 0.5773021883876015, 0.23703835935252648, 0.6023249577262025, 0.773750806112092, 1.2208674317753203, 1.199667941286403, 0.6310024371045868, 0.4388065086962609, 0.5478878777038035, 0.6247817223259977]
	betas_rfi_predator=[0.5813607480634874, 0.46500139515236366, 0.022037823768344143, 0.4210891530308329, 0.13629339612127309, 0.21123053914777248, 0.8153866193147118, 0.173034882865118, 1.2013890206152986, 0.8337937305809614, 1.7454396901026794, 1.3038966291234695, 0.3977484609912338, 0.4417885124254332, 0.3506774404508218, 0.594444359778576, 1.2672890430258617, 0.2498904182573718, 1.304227373220293, 0.24879778917853987, 0.7238826940291087, 0.14917206291145454, 0.40970440626443216, 0.7739384349231968, 0.2894776914222145, 0.1539148531797498, 0.20388301818473492, 0.9403608407524155, 0.5472282208633708, 0.3452607544060491, 2.4462244334891663, 0.27288337753171305, 1.123141844425255, 0.5736156511131265, 1.440372592782029, 0.23844600611558803, 1.7677375892755878, 0.7002695721286292, 0.7550044487104126, 0.1858162765165882, 0.15650217150714524, 0.5528427929112373, 0.48452632726844397, 0.6041644173094095, 0.3296861506950335, 2.1175421590273293, 1.5857464093134817, 1.3385728879696275, 1.6151657551343435, 1.6509465770110063, 1.7954900853986233, 1.2998506517473412, 1.6665563086617816, 0.8147137296643906, 1.3117634348081206, 0.2575065704197746, 0.22782257964126051, 0.2666183950937404, 0.9560755571477461, 0.3622808602542228, 0.15475438274659875, 0.3801620721045771, 0.6617563917907218, 0.5568675564312904, 1.210370113183292, 0.6968765000151409, 0.6614114171813925, 0.46635454801903004, 0.6612540640823149, 1.650604913449891, 0.3525236460732731, 0.4474550642637168, 0.5477143469088364, 0.4510639156989574, 0.0427191410432032, 0.7029363784073258, 0.2536421898958513, 0.6185421380277689, 0.30606654157982743, 1.1393893066996725, 0.20881672268110665, 0.13636894896533566, 1.6256422311635068, 1.154356475728921, 1.2345682519109054, 0.06847218889733361, 0.9755956503564591, 0.47518176697233316, 0.6229888645544398, 0.45280788835574237, 0.35808485460078543, 0.30921212117720986, 0.24462225366170864, 2.6643607542674603, 0.08776591833312931, 0.6431511032830839, 0.32103768482399, 0.5478947417715673, 0.4450283293511528, 0.8866743885242757, 2.433350083259334, 0.2474660173003349, 0.2602769311070811, 1.0286652924950075, 1.8135916951788744, 0.32222582318952403, 0.42452502488323207, 1.8965449782176882, 2.243078027449153, 0.22952174103227357, 0.3161811408271306, 0.7177958880569163, 0.5097896834371897, 0.3649884854988208, 0.4527696601728975, 1.6292295266117782, 0.9618425185561703, 1.534401751595094, 0.7924368143819853, 0.3346494832429789, 0.3840384722354999, 0.4420818547728413, 0.2307622435788997, 0.24236238411113703, 0.7261816079958722, 0.19643063491494409, 0.19237045488199622, 0.3434242503026401, 0.4833325743687742, 0.33752691973716054, 0.6673197675378232, 0.1725027907667647, 1.8700656948736198, 0.661857133212305, 0.11021091252115008, 0.6231186018610759, 0.6445161440684875, 1.7113866541877052, 0.9937207197738676, 2.4323016073620867, 0.5538391552004449, 1.0528403262697563, 0.7782662662059137, 0.2787103369442513, 0.23108314875420788, 1.4786432674926266, 0.7314043631946712, 1.1436203119536688, 1.8500755573420808, 0.20710128458690752, 1.472457425209345, 0.8526311623243544, 0.9688767107755216, 0.566393724989701, 0.3746118935023774, 0.46984591903220185, 0.5234681651709919, 0.22178386796450436, 0.3840869303674608, 0.2984492752336955, 0.89814283928682, 0.8713963926495465, 1.1097570531832615, 2.2819203520167215, 0.7619248410211255, 0.5440086268410668, 0.33537710361043765, 0.8490598321506136, 0.3982305456693872, 0.34421040709373085, 0.14075787006040746, 0.16626012480849223, 0.23436988696862987, 0.5655378342532504, 0.2025518151909286, 0.5559522289022872, 0.34314826834987766, 1.2491903465493035, 0.6518938395988793, 0.5886509507040979, 0.5867568434030319, 0.5436104547785391, 1.8625657126380506, 0.14309680423016044, 0.31071472725139515, 0.3504535524632973, 0.30961707131729027, 0.3025099641199006, 1.5039354159586646, 1.0108989466448435, 0.23975490460891613, 1.972460309083591]

	both_rfi=betas_rfi_reward+betas_rfi_predator
	random.shuffle(both_rfi)
	random.shuffle(both_rfi)
	random.shuffle(both_rfi)
	# rfi_rews=list(gammarnd(1.13, 0.53,num_subjects))
	# rfi_preds=list(gammarnd(1.13, 0.53,num_subjects))

	rfi_rews=random.choices(both_rfi, k=192)
	rfi_preds=random.choices(both_rfi, k=192)

	SDs.append(np.std(rfi_rews))
	SDs.append(np.std(rfi_preds))
	median_diffs.append(np.median(rfi_rews)-np.median(rfi_preds))
	mean_diffs.append(np.mean(rfi_rews)-np.mean(rfi_preds))

print('mean of median diffs {}'.format(np.median(mean_diffs)))
sigs=[x for x in mean_diffs if x < -0.188]
print('0.192 is sig at p value means: {}'.format(len(sigs)/simulations))
sigs=[x for x in median_diffs if x < -0.188]
print('0.192 is sig at p value meDIans: {}'.format(len(sigs)/simulations))
print('SD of median diffs null {}'.format(np.std(mean_diffs)))
print('SD of raw data : {}'.format(np.mean(SDs)))
temp_f=pd.Series(median_diffs,name='median differences of null')
sns.distplot(temp_f)
plt.savefig("median_diffs_same_dist.png",bbox_inches='tight', dpi=300)
plt.ylabel('density')
plt.show()

temp_f=pd.Series(mean_diffs,name='mean differences of null')
sns.distplot(temp_f)
plt.savefig("mean_diffs_same_dist.png",bbox_inches='tight', dpi=300)
plt.ylabel('density')
plt.show()